import{decorateButtons as S,decorateIcons as b,decorateSections as v,decorateBlocks as w,getMetadata as m,decorateTemplateAndTheme as A,loadSection as x,waitForFirstImage as L,loadSections as T,loadHeader as N,loadFooter as C,loadCSS as h,_ as q,buildBlock as g}from"./aem.min.js";const u=(e,t,n)=>{const o=document.createElement(e);if(t&&Object.keys(t).forEach(r=>{const s=t[r];if(r==="class"){const c=typeof s=="string"?[s]:s;o.classList.add(...c)}else o.setAttribute(r,s)}),n){const r=s=>{s instanceof HTMLElement||s instanceof SVGElement?o.append(s):o.insertAdjacentHTML("beforeend",s)};Array.isArray(n)?n.forEach(r):r(n)}return o},z=e=>{const t=["/fragments/","/forms/"];e.querySelectorAll("picture").forEach(o=>{var c,a;if(((c=o.nextElementSibling)==null?void 0:c.tagName)==="BR"&&((a=o.nextElementSibling.nextElementSibling)==null?void 0:a.tagName)==="A"){const i=o.nextElementSibling.nextElementSibling;if(i.textContent.includes(i.getAttribute("href"))){if(t.some(l=>i.getAttribute("href").includes(l)))return;o.nextElementSibling.remove(),i.innerHTML=o.outerHTML,o.replaceWith(i)}return}const r=o.parentElement,s=r.nextElementSibling;if(r.tagName==="P"&&(s==null?void 0:s.tagName)==="P"&&s.children.length===1){const i=s.querySelector("a");if(i&&i.textContent.includes(i.getAttribute("href"))){if(t.some(l=>i.getAttribute("href").includes(l)))return;i.parentElement.remove(),i.innerHTML=o.outerHTML,o.replaceWith(i)}}})},k=e=>{if(e&&e.parentNode){const t=e.parentNode;Array.from(e.childNodes).forEach(o=>{t.insertBefore(o,e)}),t.removeChild(e)}},B=e=>{if(!(e instanceof HTMLElement)||e.tagName.toLowerCase()!=="div")throw new Error("The provided element must be a <div>.");return!Array.from(e.childNodes).some(t=>{if(t.nodeType===Node.TEXT_NODE)return t.textContent.trim().length>0;if(t.nodeType===Node.ELEMENT_NODE){const n=t.tagName.toLowerCase();return n==="p"||["h1","h2","h3","h4","h5","h6"].includes(n)?t.textContent.trim().length>0:(["img","video","iframe","object","embed","svg"].includes(n),!0)}return!1})};function I(e){const t=e.querySelector("h1");if(!t)return;const n=e.querySelector("picture"),o=e.querySelector("p > em"),r=e.querySelector("u"),s=n&&n.closest("div");if(t&&n&&t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_PRECEDING&&t.parentElement===s){const c=document.createElement("div"),a=o&&o.parentElement.previousElementSibling===t,i=[];e.querySelectorAll(":scope > div:first-child .button-container").forEach(d=>{d.parentElement===s&&i.push(d)});const l=r&&(r.parentElement.previousElementSibling.classList.contains("button-container")||r.parentElement.previousElementSibling===o.parentElement||r.parentElement.previousElementSibling===t),p=u("div",{class:"hero-content"},[t,...a?[u("div",{class:["hero-subtitle","h6"]},o)]:[],...i.length?[u("div",{class:"hero-ctas"},[...i])]:[],...l?[u("div",{class:"hero-footnote"},r)]:[]]);[o,r].forEach(d=>{d&&k(d)});const y=[n,p];c.append(g("hero",{elems:y})),e.prepend(c);const f=c.nextElementSibling;B(f)&&f.remove()}}function P(e){e.querySelectorAll("a").forEach(t=>{const n=t.getAttribute("href");if(n){const o=n.split(".").pop().trim();(!n.startsWith("/")&&!n.startsWith("#")||o==="pdf")&&(t.setAttribute("target","_blank"),t.classList.add("external"))}})}function _(e){e.querySelectorAll(":scope > div div.section-metadata").forEach(t=>{let n;if([...t.querySelectorAll(":scope > div")].every(o=>{var s,c;const r=(s=o.children[1])==null?void 0:s.textContent.toLowerCase().trim().match(/(image[\s-](left|right))/i);return((c=o.children[0])==null?void 0:c.textContent.toLowerCase().trim())==="style"&&r?(n=r[1].replaceAll(/\s/g,"-"),!1):!0}),n){const o=t.parentElement,r=[],s=[];[...o.children].forEach(a=>{const i=a.querySelector(":scope > picture");i?(s.push(i),a.remove()):a.classList.contains("section-metadata")||r.push(a)});const c=g("floating-images",[[{elems:r},{elems:s}]]);c.classList.add(n),o.prepend(c)}})}async function E(e){await h(`${window.hlx.codeBasePath}/styles/themes/${e}/fonts.css`);try{window.location.hostname.includes("localhost")||sessionStorage.setItem("fonts-loaded","true")}catch{}}function H(e){e.querySelectorAll(":scope div > picture.section-bg-image").forEach(t=>{const n=t.parentElement;n.classList.add("section-bg-image-wrapper"),n.parentElement.replaceWith(n)})}function D(e){try{I(e),_(e)}catch(t){console.error("Auto Blocking failed",t)}}function M(e){S(e),b(e),D(e),v(e),w(e),H(e),P(e)}async function F(e,t){const n=e.querySelector("#theme-styles");n.href=`${window.hlx.codeBasePath}/styles/themes/${t}/${t}.css`}async function O(e){const t=m("theme")||"takeda";document.documentElement.lang="en",A(),await F(e,t);const n=e.querySelector("main");n&&(M(n),document.body.classList.add("appear"),await x(n.querySelector(".section"),L));try{(window.innerWidth>=900||sessionStorage.getItem("fonts-loaded"))&&E(t)}catch{}}async function W(e){const t=m("theme")||"takeda",n=e.querySelector("main");await T(n);const{hash:o}=window.location,r=o?e.getElementById(o.substring(1)):!1;o&&r&&r.scrollIntoView(),N(e.querySelector("header")),C(e.querySelector("footer")),h(`${window.hlx.codeBasePath}/dist/styles/lazy-styles.min.css`),E(t)}function $(){window.setTimeout(()=>q(()=>import("./delayed.min.js"),[]),3e3)}async function j(){await O(document),await W(document),$()}j();export{u as c,P as decorateExternalLinks,M as decorateMain,k as r,z as w};
